<p id="notice"><%= notice %></p>

<div id="error_message" style="color: red;"></div>


<div class="container">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <form>
                <div class="form-group">
                    <label for="title">タイトル</label>
                    <input type="text" class="form-control" id="title" name="title">
                </div>
                <div class="form-group">
                    <label for="date">作業日</label>
                    <input type="date" class="form-control" id="date" name="date">
                </div>
                <div class="form-group">
                  <label for="task">作業内容</label>
                  <select class="form-control" id="task" name="task">
                    <option value="daily">日常点検</option>
                    <option value="legal">法定点検</option>
                    <option value="tuning">チューニング</option>
                    <option value="carwash">洗車</option>
                    <option value="maintenance">メンテナンス</option>
                  </select>
                </div>
                <div class="form-group">
                    <label for="difficulty">作業難易度</label>
                    <select class="form-control" id="difficulty" name="difficulty">
                        <option value="easy">簡単</option>
                        <option value="normal">普通</option>
                        <option value="difficult">難しい</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tool_images">使用工具画像（最大4枚）</label>
                    <input type="file" class="form-control-file" id="tool_images" name="tool_images" multiple>
                </div>
                <div class="form-group">
                    <label for="time">作業時間</label>
                    <input type="text" class="form-control" id="time" name="time">
                </div>
                <div class="form-group">
                    <label for="price">作業料金</label>
                    <input type="text" class="form-control" id="price" name="price">
                </div>
                <div class="form-group">
                  <label>作業画像</label>
                  <input type="file" name="work_image[]" multiple>
                </div>
                <div class="form-group">
                  <label>作業説明</label>
                  <textarea name="work_description[]"></textarea>
                </div>
                <div class="input_fields_wrap"></div>
                <button class="add_field_button">追加</button>
                <script>
                document.addEventListener('DOMContentLoaded', function() {
                  var addButton = document.querySelector('.add_field_button');
                  var inputFieldsWrap = document.querySelector('.input_fields_wrap');
                  var x = 1;

                  addButton.addEventListener('click', function(e) {
                    e.preventDefault(); 

                    if (x < 10) {
                        x++;
                        var newField = document.createElement('div');
                        newField.innerHTML = `
                        <div class="form-group">
                          <label>作業画像</label>
                          <input type="file" name="work_image[]" multiple>
                        </div>
                      <div class="form-group">
                        <label>作業説明</label>
                        <textarea name="work_description[]"></textarea>
                      </div>`;
                      inputFieldsWrap.appendChild(newField);
                    }
                  });
                });
                </script>
                <div class="form-group">
                    <label for="related_url">関連情報URL</label>
                    <input type="text" class="form-control" id="related_url" name="related_url">
                </div>
                <button type="submit" class="btn btn-primary">作成</button>
            </form>
        </div>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var form = document.querySelector('form');

    form.addEventListener('submit', function(event) {
      var title = document.getElementById('title').value;
      var date = document.getElementById('date').value;
      var description = document.querySelector('textarea[name="work_description[]"]').value; 

      var errorMessage = document.getElementById('error_message');

      errorMessage.innerText = '';

      if (title.trim() === '' || date.trim() === '' || description.trim() === '') {
          event.preventDefault();
          document.getElementById('error_message').innerText = 'タイトル・作業日・作業説明は必須項目です。入力してください。';
      }
    });
});
</script>